<!DOCTYPE html> <!-- defines that this document is an HTML5 document -->
<!-- Comment. It may span multiple lines -->

<html> <!-- the root element of an HTML page -->
 
    <head> <!-- contains meta information about the HTML page -->
        <title>Hello World</title>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

        <script type="text/JavaScript">
            window.onload = getOrders();

            async function getOrders() {
                let response = await fetch("/orders",  {
                    method: 'GET'
                })
                if (response.ok) { // if HTTP-status is 200-299
                    // get the response body (the method explained below)
                    let json = await response.json()
                    for(let i = 0; i < json.orders.length; i++) {
                        var orderItem = document.createElement("li");
                        orderItem.innerHTML = "Order " + (i + 1) + ":" + JSON.stringify(json.orders[i]);
                        // for(var key in json.orders[i]) {
                        //     var orderDetail = document.createElement("p");
                        //     orderItem.orderDetail = "" + key + " : " + json.orders[i][key];
                        //     orderItem.append(orderDetail);
                        // }
                        $("#listOfOrders").append(orderItem);
                    }
                } else {
                    alert("HTTP-Error: " + response.status)
                    console.log(response.status)
                    let json = await response.json()
                    console.log(json)
                }
            }

            async function logout() {
                let response = await fetch("/auth",  {
                    method: 'DELETE'
                })
                if (response.ok) { // if HTTP-status is 200-299
                    // get the response body (the method explained below)
                    let json = await response.json()
                    console.log(json)
                    window.location.href='/signin.html'

                } else {
                    alert("HTTP-Error: " + response.status)
                    console.log(response.status)
                    let json = await response.json()
                    console.log(json)
                }
            }

        </script>
        
    </head>

    <body> <!-- defines the document's body, and is a container for all the visible contents -->
        <h3>Orders:</h3>
            <ul id="listOfOrders">

            </ul>

            <button type="logout" onclick="logout()" class="btn btn-primary">Log Out</button>   
        
    </body>

</html>